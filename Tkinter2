import tkinter as tk
from tkinter import filedialog
import pandas as pd

# Creates Tk root widget, which initializes Tkinter. This is a window with a title bar and other decoration provided by 
# the window manager.
root = tk.Tk()

# Defines what the dialog box looks like.
canvas1 = tk.Canvas(root, width = 300, height = 300, bg = 'lightsteelblue')
canvas1.pack()

# Creates function and global "df" variable.
def getExcel ():
    global df

# Defines file path for shortcut to finding WSO files. User selects specific file.    
    import_file_path = filedialog.askopenfilename(initialdir = "T:/Operations/Middle Office/Data/WSO Reports",title = "Select file",filetypes = (("excel files","*.xlsx"),("all files","*.*")))
# Names "xls" as the workbook and two specific sheets within the workbook as "df1" and "df2".
    xls = pd.ExcelFile (import_file_path)
    df1 = pd.read_excel(xls, sheet_name="LoanRefData")
    df2 = pd.read_excel(xls, sheet_name="Contracts")
# Performs an outer join on the LoanXID column, and names "df" as the join of both sheets
    df = (pd.merge(df1,df2,on="LoanXID",how='outer'))
    print(df)

# Executes the button command
browseButton_Excel = tk.Button(root, text='Import Excel File', command=getExcel, bg='green', fg='white', font=('helvetica', 12, 'bold'))
canvas1.create_window(150, 150, window=browseButton_Excel)

# The mainloop is created. The window won't appear until we enter the Tkinter event loop.
root.mainloop()

# Saves the newly created "df" as a new excel file in a new location.
df.to_excel(r"T:\Operations\Middle Office\Markit-EDM\Bank Loans\Python\WSO File 1.xlsx")
